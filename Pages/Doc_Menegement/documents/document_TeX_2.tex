\documentclass[a4paper,12pt]{article}         % класс документа - статья. Также report, book и др.
\usepackage{geometry}           % пакет для задания полей страницы командой \geometry
\geometry{left=3cm,right=1.5cm,top=2cm,bottom=2cm}
\usepackage[cp1251]{inputenc}   % кодировка текста
\usepackage{mathtext}           % позволяет использовать русские буквы в формулах
\usepackage[T2A]{fontenc}       %пакет Т2А необходим для правильного отображения кириллицы и переноса слов
%\inputencoding{cp1251}          % тоже кодировка...
\usepackage[russian]{babel}     % языковой пакет - последний язык главный
\usepackage[unicode]{hyperref}  %создаёт гиперссылки на список литературы в pdf-файле
\usepackage{amstext,amsmath,amssymb}            % пакеты для формул
\usepackage{bm}                 % boldmath - пакет для жирного шрифта
\usepackage[pdftex]{graphicx}   % пакет для включения рисунков в форматах png,pdf,jpg,mps,tif
                                % надо компилировать сразу в pdf
\usepackage{amsfonts}           % греческие символы и, возможно, что-то ещё
\usepackage{indentfirst}        % одинаковый отступ для первого параграфа и всего остального
\usepackage{cite}               % команда /cite{1,2,7,9} даёт ссылки
\usepackage{multirow}           % пакет для объединения строк в таблице: надо указать число строк и ширину столбца
\usepackage{array}              % нужен для создания таблиц
\linespread{1.3}                % полтора интервала. Если 1.6, то два интервала
\pagestyle{plain}               % номерует страницы

\title{Дипломная работа}

\bibliographystyle{unsrt}

\begin{document}
\begin{titlepage}
\begin{center}
Министерство образования и науки РФ

ФГАОУ ВО Дальневосточный федеральный университет \flqq ДВФУ\frqq\\

Школа естественных наук\\
Кафедра компьютерных систем\\
\end{center}

\vspace{5cm}

\begin{center}
\LARGE \bf{РАЗРАБОТКА АЛГОРИТМА РАСЧЕТА ПЛОТНОСТИ СОСТОЯНИЙ ВЕКТОРНЫХ МОДЕЛЕЙ}
\end{center}

\begin{center}\large
Диплом на соискание степени бакалавра и поиска смысла жизни
\end{center}

\vspace{3cm}

\large
\begin{flushright}
\textbf{Выполнил:}\\
студент группы Б8118-09.03.02\\
Чесноков Михаил Алексеевич\\

\vspace{1cm}

\textbf{Научный руководитель:}\\
д.ф-м.н. \\
профессор Петрович
\end{flushright}

\vspace{1cm}

\begin{center}
Владивосток 2021
\end{center}

\end{titlepage}

%\maketitle

\section{Равенство P и NP классов сложности.}\label{sec1}
Проблема равенства классов P и NP является самой важной нерешенной проблемой в области информатики и одной из семи «задач тысячелетия». \cite{sh}. 

Пропустить данную секцию: \ref{sec2}. Для оценки сложности системы существует множество различных мер, среди которых самой важной считается время. К классу P (от Polynomial) относятся задачи, для которых существует алгоритм, способный дать решение за полиномиальное время. К классу NP (от Non-deterministic Polynomial) относят задачи, для которых за полиномиальное время можно только проверить решение. Для P класса сложности примером может служит линейная зависимость времени расчетов от кол-ва входных данных, для NP – экспоненциальная зависимость. Точная формулировка вопроса равенства P и NP классов была введена в 1971 году Стивеном Куком в его оригинальной статье «Сложность процедур доказывания теорем». С этой статьи развивается теория NP-полных задач. 

\subsection{Вопрос равенства P и NP классов сложности}\label{sub1}
В итоге, проблему равенства классов P и NP возможно сформулировать следующим образом: если решение задачи можно проверить за полиномиальное время, возможно ли подобрать для нее полиномиальный алгоритм решения. Иными словами, можно ли решить задачу также быстро, как и проверить решение.

\newpage
\section{Модель Изинга. Алгоритмы Монте-Карло.}\label{sec2}
К первой секции: \ref{sec1}. Выбор между полным перебором и приближенными методами в первую очередь зависит от специфики задачи. Полный перебор подходит только для небольших моделей, в тоже время приближенные методы могут давать неточные решения. В данной работе рассматривается Каирская решетка, - частный случай искусственного спинового льда, основанного на модели Изинга. Все связанные с моделью Изинга задачи относятся к NP классу сложности.

\subsection{Модель Изинга.}\label{sub2}
Модель Изинга является математической моделью, используемой для описания множества физических систем. Она состоит из набора спинов, соответствующих каждой вершине кристаллической решетки вещества. Спины принимают состояния 1 или -1 в соответствии с направлением магнитными моментами атомов. Простейшая 2D модель Изинга является квадратной матрицей спинов, чье общее число равно N. При прохождении точки Кюри спины скачком принимают одинаковые значения, что соответствует резкому фазовому переходу и проявлению магнитных свойств веществом. Гамильтониан, то есть оператор полной энергии системы, для двумерной модели находится по формуле \ref{eq1}:


\begin{equation}\label{eq1} 
	H=-J \sum_{I,j} s_i \cdot s_j
\end{equation}


Здесь J – обменная константа, принимающей положительное значение для ферромагнетиков и отрицательное для антиферромагнетиков. Под ферромагнетиком понимается вещество, проявляющее магнитные свойства при прохождении температуры Кюри, когда спины выстраиваются параллельно друг другу; для антиферромагнетиков – антипараллельно, то есть навстречу друг другу. (См. Рис. \ref{Ising}). 

\begin{figure}[h]
	\begin{center}
		\includegraphics[scale=0.2]{Ising}
		\caption{Простейшая 2D модель Изинга}
		\label{Ising}
	\end{center}
\end{figure}

\vskip 0.3in

Также формулу можно зациклить, чтобы было смешно: \ref{eq2}.  %\vskip 0.3in

\begin{multline}\label{eq2} 
	H = -J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j \\-J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j -J\displaystyle\sum_{i,j} S_i*S_j
\end{multline}



Исследуя поведение модели при различной температуре, можно определить основные термодинамические характеристики. В процессе образуются различные конфигурации спинов. Основным состоянием называется конфигурация с минимальной суммарной энергией взаимодействия спинов. Если минимальную энергию имеет несколько конфигураций, то основное состояние считается вырожденным.
Единственным исчерпывающим способом получения точных результатов является полный перебор всех возможных конфигураций системы, то есть всех два в степени N вариаций \cite{max}. Главной проблемой данного метода является то, что число конфигураций экспоненциально увеличивается при увеличении числа спинов. Например, добавление единицы к размеру матрицы с N=5 увеличивает число конфигураций в 2 тысячи раз. Это иногда равносильно увеличению длительности выполнения реальных расчетов на время, сравнимое с годами (Рис. \ref{pol}).

\begin{figure}[t]
	\begin{center}
		\includegraphics[scale=0.3]{pol}
		\caption{Планета после расчета метом полного перебора}
		\label{pol}
	\end{center}
\end{figure}


\subsection{Алгоритмы Монте-Карло.}\label{sub3}
Существует ряд алгоритмов компьютерного моделирования, стремящихся различными способами снизить время расчета до полиномиального, предоставляя приближенное к точным результатам решение.
Методы Монте-Карло являются распространенными методами модулирования поведения различных моделей, использующийся, как и в физике, так и в химии, экономике и других областях. При исследовании термодинамических свойств веществ при фазовом переходе метод Монте-Карло (Рис. \ref{MC}) считается основным статистическим методом для низкоразмерных структур.


В первую очередь будет рассмотрен алгоритм Метрополиса, позволяющий легко найти энергию, намагниченность и теплоемкость исследуемой модели.
В отличие от полного перебора, рассматриваются случайно сгенерированные конфигурации спинов. На каждом температурном шаге производится случайное блуждание по системе: выбирается спин, чье значение меняется на противоположное – «переворачивается». Новая конфигурация принимается с определенной вероятностью, зависящей от изменения энергии системы и текущей температуры. Для статистически верного моделирования поведения системы производится усреднение, то есть изменение конфигурации проводится большое число раз для каждого температурного шага, пока отклонение системы не достигнет минимума. Фундаментальной проблемой алгоритма Метрополиса является критическое замедление его работы при совершении системой фазового перехода.

\begin{figure}[b]
	\begin{center}
		\includegraphics[scale=0.3]{MC}
		\caption{Численное интегрирование функции методом Монте-Карло}
		\label{MC}
	\end{center}
\end{figure}

Другим распространенным алгоритмом, относящимся к методу Монте-Карло, является алгоритм Ванга-Ландау, использующийся для вычисления плотности состояния систем. Он также основывается на работе со случайно изменяющимися конфигурациями, однако, в отличие от алгоритма Метрополиса, использует гистограмму энергетических состояний системы для более равновероятного распределения возможных конфигураций.

Первая конфигурация генерируется случайным образом, начальными условиями являются некая плотность состояния, пустая гистограмма и модификационный фактор. При случайном блуждании по системе выбирается спин, который при определенной вероятности переворачивается, образуя новую конфигурацию в пределах цикла усреднения для определенного модификационного фактора. Число посещений каждого возможного значения энергии конфигурации отражается в гистограмме, влияющей на вероятность принятия новой конфигурации. Таким образом, принятие конфигурации с энергией, встречаемой чаще других, будет в будущем чаще откланяться, тем самым регулируя достаточно ли гладка гистограмма, то есть, насколько сильно в процентном соотношении различается число посещенных энергетических состояний. Чем больше требуемый процент гладкости гистограммы, тем больше итераций требует цикл усреднения и, следовательно, благодаря этому растет время расчетов. На практике обычно выбирается компромисс между равновероятностью и скоростью, например, 80 процентов.

После достижения достаточно гладкой гистограммы, она очищается, начальная плотность состояния умножается на модификационный фактор, который после этого неким способом уменьшается, например, делится надвое, либо на некое другое число, пропорциональное шагу моделирования. Нахождение плотности состояний продолжается пока значение модификационного фактора больше заданной точности.

Существует ряд кластерных алгоритмов, направленных на решение проблемы критического замедления алгоритма Метрополиса. Под кластерами понимается цепочка непрерывно связанных спинов с одинаковыми значениями. Вместо одного спина переворачивается все спины, входящие в кластер, что снижает количество операций. Самыми распространенными кластерными алгоритмами являются алгоритмы Свендсена-Ванга и алгоритм Вольфа.

Алгоритм Свендсена-Ванга является многокластерным. При его использовании каждый спин в матрице принадлежит к какому-либо кластеру, даже если он является единственным спином в нем. При формировании кластера выбирается спин в левом нижнем углу, рассматриваются его соседи, при условии, что они имеют одинаковое значение. С определенной вероятностью, зависящей от текущей температуры, они принимаются в один кластер. Идентификация второго кластера не начинаются пока в первом кластере не заканчиваются непроверенные соседи спинов, вошедших в этот кластер. Далее процесс повторяется для всех остальных незанятых спинов. Когда формирование кластеров заканчивается, все значения в каждом кластере переворачиваются с вероятностью 50 процентов. Для каждой новой конфигурации формирование кластеров начинается заново.

В однокластерном алгоритме Вольфа используется тот же способ формирования кластера, однако, как понятно из названия, создается только один кластер. Позиция спина, который становится первым элементом кластера, выбирается случайно. Преимуществом алгоритма Вольфа над алгоритмом Свендсена-Ванга является то, что он имеет вероятность формирования кластеров большего размера, следовательно, число переворачиваемых за раз спинов статистически больше, что обеспечивает меньшее число расчетов.

Последним из рассматриваемых алгоритмов служит репличный обменный алгоритм Монте-Карло. Он также, как и предыдущие алгоритмы, предлагает вариант решения проблемы критического замедления алгоритма Метрополиса.

\begin{table}[t]
	\caption{Статистическая таблица 1}
	\label{tab1}
	\begin{center}
		\begin{tabular}{ | l | l | l | }
			\hline
			Статистика 1: & \textbf{1,0-1,4} & Да \\\hline
			Статистика 2: & \textbf{0,25-0,30} & Да \\ \hline
			Статистика 3: & \textbf{0,25-0,50} & Нет \\ \hline
		\end{tabular}
	\end{center}
\end{table}

\begin{equation}\label{eq3} 
	B=-HAHA \sum_{J,i} Scene_I \cdot Scene_J
\end{equation}

В основе алгоритма лежат реплики – копии системы, созданные для различных температур. Количество реплик напрямую влияет на точность вычисления, в то же время скорость вычисления также напрямую зависит от их числа \cite{mu}. Конфигурация спинов, как и в предыдущих методах, формируется случайным образом. На каждом шаге усреднения реплики обмениваются конфигурацией с определенной вероятностью, зависящей от разницы энергии и температуры обменивающихся реплик.
Репличный обменный алгоритм можно совместить с последовательным алгоритмом Ванга-Ландау для получения оного из вариантов параллельной реализации последнего. В нем пространство состояний разделено на перекрывающиеся энергетические зоны или интервалы. Для каждого интервала определено равное количество процессов, совмещающих в себя характеристики обоих алгоритмов. Так у процесса есть своя обновляемая гистограмма, плотность состояний и модификационный фактор. Во время моделирования процессы, как реплики, обмениваются конфигурациями с двумя ближайшими соседями. 

Посмотрим на таблицу \ref{tab1}, а потом на таблицу \ref{tab2}. 

Они не отличаются! Ч.Т.Д.

\begin{table}[h]
	\caption{Статистическая таблица 2}
	\label{tab2}
	\begin{center}
		\begin{tabular}{ | l | l | l | }
			\hline
			Статистика 1: & \textbf{1,0-1,4} & Да \\\hline
			Статистика 2: & \textbf{0,25-0,30} & Да \\ \hline
			Статистика 3: & \textbf{0,25-0,50} & Нет \\ \hline
		\end{tabular}
	\end{center}
\end{table}

Изменение плотности состояния и модификационного фактора соответствует операциям из последовательного алгоритма.

Результаты, получаемые с помощью параллельного алгоритма Ванга-Ландау, хорошо сходятся с последовательным алгоритмом, а время, затрачиваемое на расчеты, уменьшается. И еще одна формула "хаха": \ref{eq3}.

\newpage

Пару таблиц для продолжения поиска себя:

\begin{enumerate} 
	\item Никому не рассказывать о бойцовском клубе.
	\item Никогда никому не рассказывать о бойцовском клубе.
	\item Если противник потерял сознание или делает вид, что потерял, или говорит «Хватит» — поединок окончен.
	\item В схватке участвуют только двое.
	\item Не более одного поединка за один раз.
	\item Бойцы сражаются без обуви и голые по пояс.
	\item Поединок продолжается столько, сколько потребуется.
	\item Новичок обязан принять бой.
\end{enumerate}

\vskip 1in

\begin{itemize}
	\item Не задавать вопросов о проекте «Разгром».
	\item Никогда не задавать вопросов о проекте «Разгром».
	\item Оправдания не принимаются.
	\item Не лгать.
	\item Тайлер всегда прав.
\end{itemize}



\newpage
\bibliography{links}

\end{document}